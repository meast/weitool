<h3> <span class="mw-headline" id=".E8.8E.B7.E5.8F.96.E5.AE.A2.E6.9C.8D.E8.81.8A.E5.A4.A9.E8.AE.B0.E5.BD.95.E6.8E.A5.E5.8F.A3"><b>获取客服聊天记录接口</b></span></h3><p>在需要时，开发者可以通过获取客服聊天记录接口，获取多客服的会话记录，包括客服和用户会话的所有消息记录和会话的创建、关闭等操作记录。利用此接口可以开发如“消息记录”、“工作监控”、“客服绩效考核”等功能。</p><p><b>接口调用请求说明</b></p><p>http请求方式: POST</p><pre><a href="https://api.weixin.qq.com/cgi-bin/customservice/getrecord?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://api.weixin.qq.com/cgi-bin/customservice/getrecord?access_token=ACCESS_TOKEN</a></pre><p><b>POST数据说明</b></p><pre>POST数据示例如下：{     "starttime"&#160;: 123456789,     "endtime"&#160;: 987654321,     "openid"&#160;: "OPENID",     "pagesize"&#160;: 10,     "pageindex"&#160;: 1,}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th style="width:120px">是否必须</th><th>说明</th></tr><tr><td> access_token</td><td> 是</td><td> 调用接口凭证</td></tr><tr><td> openid</td><td> 否</td><td> 普通用户的标识，对当前公众号唯一</td></tr><tr><td> starttime</td><td> 是</td><td> 查询开始时间，UNIX时间戳</td></tr><tr><td> endtime</td><td> 是</td><td> 查询结束时间，UNIX时间戳，每次查询不能跨日查询</td></tr><tr><td> pagesize</td><td> 是</td><td> 每页大小，每页最多拉取1000条</td></tr><tr><td> pageindex</td><td> 是</td><td> 查询第几页，从1开始</td></tr></table><p><b>返回说明</b></p><p>正常情况下，微信会返回下述JSON数据包：</p><pre>{    "recordlist": [        {            "worker": " test1",            "openid": "oDF3iY9WMaswOPWjCIp_f3Bnpljk",            "opercode": 2002,            "time": 1400563710,            "text": " 您好，客服test1为您服务。"        },        {            "worker": " test1",            "openid": "oDF3iY9WMaswOPWjCIp_f3Bnpljk",            "opercode": 2003,            "time": 1400563731,            "text": " 你好，有什么事情？ "        },    ]}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">参数</th><th>说明</th></tr><tr><td> worker</td><td> 客服账号</td></tr><tr><td> openid</td><td> 用户的标识，对当前公众号唯一</td></tr><tr><td> opercode</td><td> 操作ID（会话状态），具体说明见下文</td></tr><tr><td> time</td><td> 操作时间，UNIX时间戳</td></tr><tr><td> text</td><td> 聊天记录</td></tr></table><p>操作ID(会化状态）定义：</p><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">ID值</th><th>说明</th></tr><tr><td> 1000</td><td> 创建未接入会话</td></tr><tr><td> 1001</td><td> 接入会话</td></tr><tr><td> 1002</td><td> 主动发起会话</td></tr><tr><td> 1004</td><td> 关闭会话</td></tr><tr><td> 1005</td><td> 抢接会话</td></tr><tr><td> 2001</td><td> 公众号收到消息</td></tr><tr><td> 2002</td><td> 客服发送消息</td></tr><tr><td> 2003</td><td> 客服收到消息</td></tr></table><p>错误时微信会返回错误码等信息，请根据错误码查询错误信息：<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E5%85%A8%E5%B1%80%E8%BF%94%E5%9B%9E%E7%A0%81%E8%AF%B4%E6%98%8E" class="external text" rel="nofollow">全局返回码说明</a></p><!-- NewPP limit reportPreprocessor node count: 2/1000000Post-expand include size: 0/2097152 bytesTemplate argument size: 0/2097152 bytesExpensive parser function count: 0/100--><div class="printfooter">取自“<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%9C%8D%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95">http://mp.weixin.qq.com/wiki/index.php?title=%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%9C%8D%E8%81%8A%E5%A4%A9%E8%AE%B0%E5%BD%95</a>”</div>