<p>在公众平台网站上，为订阅号提供了每天一条的群发权限，为服务号提供每月（自然月）4条的群发权限。而对于某些具备开发能力的公众号运营者，可以通过高级群发接口，实现更灵活的群发能力。</p><p>请注意：</p><pre>1、该接口暂时仅提供给已微信认证的服务号2、虽然开发者使用高级群发接口的每日调用限制为100次，但是用户每月只能接收4条，请小心测试3、<b>无论在公众平台网站上，还是使用接口群发，用户每月只能接收4条群发消息，多于4条的群发将对该用户发送失败</b>。4、具备微信支付权限的公众号，在使用高级群发接口上传、群发图文消息类型时，可使用&lt;a&gt;标签加入外链</pre><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目录</h2></div><ul><li class="toclevel-1 tocsection-1"><a href="#.E4.B8.8A.E4.BC.A0.E5.9B.BE.E6.96.87.E6.B6.88.E6.81.AF.E7.B4.A0.E6.9D.90"><span class="tocnumber">1</span> <span class="toctext">上传图文消息素材</span></a></li><li class="toclevel-1 tocsection-2"><a href="#.E6.A0.B9.E6.8D.AE.E5.88.86.E7.BB.84.E8.BF.9B.E8.A1.8C.E7.BE.A4.E5.8F.91"><span class="tocnumber">2</span> <span class="toctext">根据分组进行群发</span></a></li><li class="toclevel-1 tocsection-3"><a href="#.E6.A0.B9.E6.8D.AEOpenID.E5.88.97.E8.A1.A8.E7.BE.A4.E5.8F.91"><span class="tocnumber">3</span> <span class="toctext">根据OpenID列表群发</span></a></li><li class="toclevel-1 tocsection-4"><a href="#.E5.88.A0.E9.99.A4.E7.BE.A4.E5.8F.91"><span class="tocnumber">4</span> <span class="toctext">删除群发</span></a></li><li class="toclevel-1 tocsection-5"><a href="#.E4.BA.8B.E4.BB.B6.E6.8E.A8.E9.80.81.E7.BE.A4.E5.8F.91.E7.BB.93.E6.9E.9C"><span class="tocnumber">5</span> <span class="toctext">事件推送群发结果</span></a></li></ul></td></tr></table><h3> <span class="mw-headline" id=".E4.B8.8A.E4.BC.A0.E5.9B.BE.E6.96.87.E6.B6.88.E6.81.AF.E7.B4.A0.E6.9D.90"> 上传图文消息素材 </span></h3><p><b>接口调用请求说明</b></p><pre>http请求方式: POST<a href="https://api.weixin.qq.com/cgi-bin/media/uploadnews?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://api.weixin.qq.com/cgi-bin/media/uploadnews?access_token=ACCESS_TOKEN</a></pre><p><b>POST数据说明</b></p><p>POST数据示例如下：</p><pre>{   "articles": [		 {                        "thumb_media_id":"qI6_Ze_6PtV7svjolgs-rN6stStuHIjs9_DidOHaj0Q-mwvBelOXCFZiq2OsIU-p",                        "author":"xxx",			 "title":"Happy Day",			 "content_source_url":"www.qq.com",			 "content":"content",			 "digest":"digest",                        "show_cover_pic":"1"		 },		 {                        "thumb_media_id":"qI6_Ze_6PtV7svjolgs-rN6stStuHIjs9_DidOHaj0Q-mwvBelOXCFZiq2OsIU-p",                        "author":"xxx",			 "title":"Happy Day",			 "content_source_url":"www.qq.com",			 "content":"content",			 "digest":"digest",                        "show_cover_pic":"0"		 }   ]}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th style="width:120px">是否必须</th><th>说明</th></tr><tr><td> Articles</td><td> 是</td><td> 图文消息，一个图文消息支持1到10条图文</td></tr><tr><td> thumb_media_id</td><td> 是</td><td> 图文消息缩略图的media_id，可以在基础支持-上传多媒体文件接口中获得</td></tr><tr><td> author</td><td> 否</td><td> 图文消息的作者</td></tr><tr><td> title</td><td> 是</td><td> 图文消息的标题</td></tr><tr><td> content_source_url</td><td> 否</td><td> 在图文消息页面点击“阅读原文”后的页面</td></tr><tr><td> content</td><td> 是</td><td> 图文消息页面的内容，支持HTML标签</td></tr><tr><td> digest</td><td> 否</td><td> 图文消息的描述</td></tr><tr><td> show_cover_pic</td><td> 否</td><td> 是否显示封面，1为显示，0为不显示</td></tr></table><p><b>返回说明</b></p><p>返回数据示例（正确时的JSON返回结果）：</p><pre>{   "type":"news",   "media_id":"CsEf3ldqkAYJAU6EJeIkStVDSvffUJ54vqbThMgplD-VJXXof6ctX5fI6-aYyUiQ",   "created_at":1391857799}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">参数</th><th>说明</th></tr><tr><td> type</td><td> 媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb），次数为news，即图文消息</td></tr><tr><td> media_id</td><td> 媒体文件/图文消息上传后获取的唯一标识</td></tr><tr><td> created_at</td><td> 媒体文件上传时间</td></tr></table><p>错误时微信会返回错误码等信息，请根据错误码查询错误信息:<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E5%85%A8%E5%B1%80%E8%BF%94%E5%9B%9E%E7%A0%81%E8%AF%B4%E6%98%8E" class="external text" rel="nofollow">全局返回码说明</a></p><h3> <span class="mw-headline" id=".E6.A0.B9.E6.8D.AE.E5.88.86.E7.BB.84.E8.BF.9B.E8.A1.8C.E7.BE.A4.E5.8F.91"> 根据分组进行群发 </span></h3><p><b>接口调用请求说明</b></p><pre>http请求方式: POST<a href="https://api.weixin.qq.com/cgi-bin/message/mass/sendall?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://api.weixin.qq.com/cgi-bin/message/mass/sendall?access_token=ACCESS_TOKEN</a></pre><p><b>POST数据说明</b></p><p>POST数据示例如下：</p><p>图文消息（注意图文消息的media_id需要通过上述方法来得到）：</p><pre>{   "filter":{      "group_id":"2"   },   "mpnews":{      "media_id":"123dsdajkasd231jhksad"   },    "msgtype":"mpnews"}</pre><p>文本：</p><pre>{   "filter":{      "group_id":"2"   },   "text":{      "content":"CONTENT"   },    "msgtype":"text"}</pre><p>语音（注意此处media_id需通过基础支持中的上传下载多媒体文件来得到）：</p><pre>{   "filter":{      "group_id":"2"   },   "voice":{      "media_id":"123dsdajkasd231jhksad"   },    "msgtype":"voice"}</pre><p>图片（注意此处media_id需通过基础支持中的上传下载多媒体文件来得到）：</p><pre>{   "filter":{      "group_id":"2"   },   "image":{      "media_id":"123dsdajkasd231jhksad"   },    "msgtype":"image"}</pre><p>视频</p><p>请注意，此处视频的media_id需通过POST请求到下述接口特别地得到：<a href="https://file.api.weixin.qq.com/cgi-bin/media/uploadvideo?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://file.api.weixin.qq.com/cgi-bin/media/uploadvideo?access_token=ACCESS_TOKEN</a>POST数据如下（此处media_id需通过基础支持中的上传下载多媒体文件来得到）：</p><pre>{  "media_id": "rF4UdIMfYK3efUfyoddYRMU50zMiRmmt_l0kszupYh_SzrcW5Gaheq05p_lHuOTQ",  "title": "TITLE",  "description": "Description"}</pre><p>返回将为</p><pre>{  "type":"video",  "media_id":"IhdaAQXuvJtGzwwc0abfXnzeezfO0NgPK6AQYShD8RQYMTtfzbLdBIQkQziv2XJc",  "created_at":1398848981}</pre><p>然后，POST下述数据（将media_id改为上一步中得到的media_id），即可进行发送</p><pre>{   "filter":{      "group_id":"2"   },   "mpvideo":{      "media_id":"IhdaAQXuvJtGzwwc0abfXnzeezfO0NgPK6AQYShD8RQYMTtfzbLdBIQkQziv2XJc",   },    "msgtype":"mpvideo"}</pre><p><br /></p><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th style="width:120px">是否必须</th><th>说明</th></tr><tr><td> filter</td><td> 是</td><td> 用于设定图文消息的接收者</td></tr><tr><td> group_id</td><td> 是</td><td> 群发到的分组的group_id</td></tr><tr><td> mpnews</td><td> 是</td><td> 用于设定即将发送的图文消息</td></tr><tr><td> media_id</td><td> 是</td><td> 用于群发的消息的media_id</td></tr><tr><td> msgtype</td><td> 是</td><td> 群发的消息类型，图文消息为mpnews，文本消息为text，语音为voice，音乐为music，图片为image，视频为video</td></tr><tr><td> title</td><td> 否</td><td> 消息的标题</td></tr><tr><td> description</td><td> 否</td><td> 消息的描述</td></tr><tr><td> thumb_media_id</td><td> 是</td><td> 视频缩略图的媒体ID</td></tr></table><p><b>返回说明</b></p><p>返回数据示例（正确时的JSON返回结果）：</p><pre>{   "errcode":0,   "errmsg":"send job submission success",   "msg_id":34182}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">参数</th><th>说明</th></tr><tr><td> type</td><td> 媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb），图文消息为news</td></tr><tr><td> errcode</td><td> 错误码</td></tr><tr><td> errmsg</td><td> 错误信息</td></tr><tr><td> msg_id</td><td> 消息ID</td></tr></table><p>请注意：<b>在返回成功时，意味着群发任务提交成功，并不意味着此时群发已经结束</b>，所以，仍有可能在后续的发送过程中出现异常情况导致用户未收到消息，如消息有时会进行审核、服务器不稳定等。此外，<b>群发任务一般需要较长的时间才能全部发送完毕，请耐心等待</b>。</p><p>错误时微信会返回错误码等信息，请根据错误码查询错误信息:<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E5%85%A8%E5%B1%80%E8%BF%94%E5%9B%9E%E7%A0%81%E8%AF%B4%E6%98%8E" class="external text" rel="nofollow">全局返回码说明</a></p><h3> <span class="mw-headline" id=".E6.A0.B9.E6.8D.AEOpenID.E5.88.97.E8.A1.A8.E7.BE.A4.E5.8F.91"> 根据OpenID列表群发 </span></h3><p><b>接口调用请求说明</b></p><pre>http请求方式: POST<a href="https://api.weixin.qq.com/cgi-bin/message/mass/send?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://api.weixin.qq.com/cgi-bin/message/mass/send?access_token=ACCESS_TOKEN</a></pre><p><b>POST数据说明</b></p><p>POST数据示例如下：</p><p>图文消息（注意图文消息的media_id需要通过上述方法来得到）：</p><pre>{   "touser":[    "OPENID1",    "OPENID2"   ],   "mpnews":{      "media_id":"123dsdajkasd231jhksad"   },    "msgtype":"mpnews"}</pre><p>文本：</p><pre>{   "touser": [</pre><p>	 "oR5Gjjl_eiZoUpGozMo7dbBJ362A",	 "oR5Gjjo5rXlMUocSEXKT7Q5RQ63Q"	],	"msgtype": "text",	"text": { "content": "hello from boxer."}</p><pre>}</pre><p>语音：</p><pre>{   "touser":[    "OPENID1",    "OPENID2"   ],   "voice":{      "media_id":"mLxl6paC7z2Tl-NJT64yzJve8T9c8u9K2x-Ai6Ujd4lIH9IBuF6-2r66mamn_gIT"   },    "msgtype":"voice"}</pre><p>图片：</p><pre>{   "touser":[    "OPENID1",    "OPENID2"   ],   "image":{      "media_id":"BTgN0opcW3Y5zV_ZebbsD3NFKRWf6cb7OPswPi9Q83fOJHK2P67dzxn11Cp7THat"   },    "msgtype":"image"}</pre><p>视频：</p><p>请注意，此处视频的media_id需通过POST请求到下述接口特别地得到：<a href="https://file.api.weixin.qq.com/cgi-bin/media/uploadvideo?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://file.api.weixin.qq.com/cgi-bin/media/uploadvideo?access_token=ACCESS_TOKEN</a>POST数据如下（此处media_id需通过基础支持中的上传下载多媒体文件来得到）：</p><pre>{  "media_id": "rF4UdIMfYK3efUfyoddYRMU50zMiRmmt_l0kszupYh_SzrcW5Gaheq05p_lHuOTQ",  "title": "TITLE",  "description": "Description"}</pre><p>返回将为</p><pre>{  "type":"video",  "media_id":"IhdaAQXuvJtGzwwc0abfXnzeezfO0NgPK6AQYShD8RQYMTtfzbLdBIQkQziv2XJc",  "created_at":1398848981}</pre><p>然后，POST下述数据（将media_id改为上一步中得到的media_id），即可进行发送</p><pre>{   "touser":[    "OPENID1",    "OPENID2"   ],   "video":{      "media_id":"123dsdajkasd231jhksad",      "title":"TITLE",      "description":"DESCRIPTION"   },    "msgtype":"video"}</pre><p><br /> </p><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th style="width:120px">是否必须</th><th>说明</th></tr><tr><td> touser</td><td> 是</td><td> 填写图文消息的接收者，一串OpenID列表，OpenID最少个，最多10000个</td></tr><tr><td> mpnews</td><td> 是</td><td> 用于设定即将发送的图文消息</td></tr><tr><td> media_id</td><td> 是</td><td> 用于群发的图文消息的media_id</td></tr><tr><td> msgtype</td><td> 是</td><td> 群发的消息类型，图文消息为mpnews，文本消息为text，语音为voice，音乐为music，图片为image，视频为video</td></tr><tr><td> title</td><td> 否</td><td> 消息的标题</td></tr><tr><td> description</td><td> 否</td><td> 消息的描述</td></tr><tr><td> thumb_media_id</td><td> 是</td><td> 视频缩略图的媒体ID</td></tr></table><p><b>返回说明</b></p><p>返回数据示例（正确时的JSON返回结果）：</p><pre>{   "errcode":0,   "errmsg":"send job submission success",   "msg_id":34182}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">参数</th><th>说明</th></tr><tr><td> type</td><td> 媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb），次数为news，即图文消息</td></tr><tr><td> errcode</td><td> 错误码</td></tr><tr><td> errmsg</td><td> 错误信息</td></tr><tr><td> msg_id</td><td> 消息ID</td></tr></table><p>请注意：<b>在返回成功时，意味着群发任务提交成功，并不意味着此时群发已经结束</b>，所以，仍有可能在后续的发送过程中出现异常情况导致用户未收到消息，如消息有时会进行审核、服务器不稳定等。此外，<b>群发任务一般需要较长的时间才能全部发送完毕，请耐心等待</b>。</p><p>错误时微信会返回错误码等信息，请根据错误码查询错误信息:<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E5%85%A8%E5%B1%80%E8%BF%94%E5%9B%9E%E7%A0%81%E8%AF%B4%E6%98%8E" class="external text" rel="nofollow">全局返回码说明</a></p><h3> <span class="mw-headline" id=".E5.88.A0.E9.99.A4.E7.BE.A4.E5.8F.91"> 删除群发 </span></h3><p><b>接口调用请求说明</b></p><pre>http请求方式: POST<a href="https://api.weixin.qq.com/cgi-bin/message/mass/delete?access_token=ACCESS_TOKEN" class="external free" rel="nofollow">https://api.weixin.qq.com/cgi-bin/message/mass/delete?access_token=ACCESS_TOKEN</a></pre><p><b>POST数据说明</b></p><p>POST数据示例如下：</p><pre>{   "msg_id":30124}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th style="width:120px">是否必须</th><th>说明</th></tr><tr><td> msg_id</td><td> 是</td><td> 发送出去的消息ID</td></tr></table><p><b>请注意，只有已经发送成功的消息才能删除删除消息只是将消息的图文详情页失效，已经收到的用户，还是能在其本地看到消息卡片。</b><b>另外，删除群发消息只能删除图文消息和视频消息，其他类型的消息一经发送，无法删除。</b></p><p><b>返回说明</b></p><p>返回数据示例（正确时的JSON返回结果）：</p><pre>{   "errcode":0,   "errmsg":"ok"}</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:240px">参数</th><th>说明</th></tr><tr><td> errcode</td><td> 错误码</td></tr><tr><td> errmsg</td><td> 错误信息</td></tr></table><p>错误时微信会返回错误码等信息，请根据错误码查询错误信息:<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E5%85%A8%E5%B1%80%E8%BF%94%E5%9B%9E%E7%A0%81%E8%AF%B4%E6%98%8E" class="external text" rel="nofollow">全局返回码说明</a></p><h3> <span class="mw-headline" id=".E4.BA.8B.E4.BB.B6.E6.8E.A8.E9.80.81.E7.BE.A4.E5.8F.91.E7.BB.93.E6.9E.9C"> 事件推送群发结果 </span></h3><p>由于群发任务提交后，群发任务可能在一定时间后才完成，因此，群发接口调用时，仅会给出群发任务是否提交成功的提示，若群发任务提交成功，则在群发任务结束时，会向开发者在公众平台填写的开发者URL（callback URL）推送事件。</p><p>推送的XML结构如下（发送成功时）：</p><pre>&lt;xml&gt;&lt;ToUserName&gt;&lt;![CDATA[gh_3e8adccde292]]&gt;&lt;/ToUserName&gt;&lt;FromUserName&gt;&lt;![CDATA[oR5Gjjl_eiZoUpGozMo7dbBJ362A]]&gt;&lt;/FromUserName&gt;&lt;CreateTime&gt;1394524295&lt;/CreateTime&gt;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;&lt;Event&gt;&lt;![CDATA[MASSSENDJOBFINISH]]&gt;&lt;/Event&gt;&lt;MsgID&gt;1988&lt;/MsgID&gt;&lt;Status&gt;&lt;![CDATA[sendsuccess]]&gt;&lt;/Status&gt;&lt;TotalCount&gt;100&lt;/TotalCount&gt;&lt;FilterCount&gt;80&lt;/FilterCount&gt;&lt;SentCount&gt;75&lt;/SentCount&gt;&lt;ErrorCount&gt;5&lt;/ErrorCount&gt;&lt;/xml&gt;</pre><table border="1" cellspacing="0" cellpadding="4" align="center" width="640px"><tr><th style="width:120px">参数</th><th>说明</th></tr><tr><td> ToUserName</td><td> 公众号的微信号</td></tr><tr><td> FromUserName</td><td> 公众号群发助手的微信号，为mphelper</td></tr><tr><td> CreateTime</td><td> 创建时间的时间戳</td></tr><tr><td> MsgType</td><td> 消息类型，此处为event</td></tr><tr><td> Event</td><td> 事件信息，此处为MASSSENDJOBFINISH</td></tr><tr><td> MsgID</td><td> 群发的消息ID</td></tr><tr><td> Status</td><td> 群发的结构，为“send success”或“send fail”或“err(num)”。但send success时，也有可能因用户拒收公众号的消息、系统错误等原因造成少量用户接收失败。err(num)是审核失败的具体原因，可能的情况如下：<p>err(10001), //涉嫌广告err(20001), //涉嫌政治err(20004), //涉嫌社会err(20002), //涉嫌色情err(20006), //涉嫌违法犯罪err(20008), //涉嫌欺诈err(20013), //涉嫌版权err(22000), //涉嫌互推(互相宣传)err(21000), //涉嫌其他</p></td></tr><tr><td> TotalCount</td><td> group_id下粉丝数；或者openid_list中的粉丝数</td></tr><tr><td> FilterCount</td><td> 过滤（过滤是指特定地区、性别的过滤、用户设置拒收的过滤，用户接收已超4条的过滤）后，准备发送的粉丝数，原则上，FilterCount = SentCount + ErrorCount</td></tr><tr><td> SentCount</td><td> 发送成功的粉丝数</td></tr><tr><td> ErrorCount</td><td> 发送失败的粉丝数</td></tr></table><!-- NewPP limit reportPreprocessor node count: 19/1000000Post-expand include size: 0/2097152 bytesTemplate argument size: 0/2097152 bytesExpensive parser function count: 0/100--><div class="printfooter">取自“<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E9%AB%98%E7%BA%A7%E7%BE%A4%E5%8F%91%E6%8E%A5%E5%8F%A3">http://mp.weixin.qq.com/wiki/index.php?title=%E9%AB%98%E7%BA%A7%E7%BE%A4%E5%8F%91%E6%8E%A5%E5%8F%A3</a>”</div>